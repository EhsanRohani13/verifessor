FROM debian:stable-slim

RUN apt-get update && \
    apt-get install -y g++ autoconf gperf flex git bison make && \
    apt-get clean

WORKDIR /usr/src

RUN git clone https://github.com/steveicarus/iverilog.git

WORKDIR /usr/src/iverilog

RUN sh autoconf.sh
RUN ./configure
RUN make -j$(nproc)
RUN make install
WORKDIR /root
RUN rm -rf /usr/src/iverilog

RUN apt-get purge -y g++ autoconf gperf flex git bison make

COPY test.sh .
ENTRYPOINT [ "/root/test.sh" ]
